"0","Q=11"
"0","CV_plot_a_olr = {}"
"0","CV_plot_b_olr = {}"
"0","for(i in 1:Q){"
"0","  CV_tmp_a_olr <- {}"
"0","  CV_tmp_b_olr <- {}"
"0","  for(k in 1:10){"
"0","    reds_train_train = reds_train[!(ids == k),]"
"0","    reds_train_val = reds_train[ids == k,]"
"0","    pc_t <- princomp(reds_train_train[,1:11],cor=T)"
"0","    pct_scores <- as.data.frame(pc_t$scores[,1:i])"
"0","    pc_v <- princomp(reds_train_val[,1:11],cor=T)"
"0","    pcv_scores <- as.data.frame(pc_v$scores[,1:i])"
"0","    train_df <- data.frame(pc_t$scores[,1:i])"
"0","    t_names = {}"
"0","    for(q in 1:i){"
"0","      t_names = append(t_names, paste(""pc"", q, sep=""""))"
"0","    }"
"0","    "
"0","    names(pct_scores) <- t_names"
"0","    names(pcv_scores) <- t_names"
"0","    "
"0","    tdf <- cbind(pct_scores, quality = reds_train_train$quality)"
"0","    vdf <- cbind(pcv_scores, quality = reds_train_val$quality)"
"0","    "
"0","    model_olr <- MASS::polr(quality ~ ., data=tdf) # Only difference from above block"
"0","    "
"0","    CV_tmp_a_olr[k] <- sum(predict(model_olr, newdata= vdf) != vdf$quality) / nrow(vdf)"
"0","    CV_tmp_b_olr[k] <- sum((as.numeric(predict(model_olr, newdata = vdf)) - as.numeric(vdf$quality))^2)"
"0"," "
"0","  }"
"0","  CV_plot_a_olr[i] = mean(CV_tmp_a_olr)"
"0","  CV_plot_b_olr[i] = mean(CV_tmp_b_olr)/nrow(vdf)"
"0","}"
